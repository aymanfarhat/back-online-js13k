<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,user-scalable=0"><meta name="apple-mobile-web-app-capable" content="yes"><meta property="og:title" content="JS13K Starter"><title>Back online! - 13KB JS Game</title><style>body{margin:0;padding:0;background:#fff;-webkit-user-select:none;-moz-user-select:none;-khtml-user-select:none;-ms-user-select:none;text-align:center}canvas{display:block;margin:0 auto;background:#FFF}</style></head><body><img src="./sprites/trex.png" id="trex" style="display:none;"> <img src="./sprites/bg.png" id="bg" style="display:none;"><canvas id="game" width="400" height="600"></canvas><script type="text/javascript">!function(i){var n={};function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=i,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.r(e);var a=function(){function a(t,e,i,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.drawContext=t,this.x=e,this.y=i,this.worldConfig=n,this.frameIndex=0,this.tickCount=0,this.ticksPerFrame=13,this.nFrames=2,this.heroWidth=86,this.heroHeight=94,this.onGround=!0,this.vy=0,this.baseY=i,this.totalDownload=0,this.totalCache=0,this.entityName="Hero",window.addEventListener("click",function(){return r.triggerJump()}),window.addEventListener("touchstart",function(t){return r.triggerJump(t)})}var t,e,i;return t=a,(e=[{key:"triggerJump",value:function(){this.onGround&&70<this.y&&(this.vy=-8)}},{key:"takeHit",value:function(t){this.totalCache=Math.ceil(this.totalCache-2*t)}},{key:"update",value:function(){this.totalDownload+=Math.ceil(this.worldConfig.speed),this.totalCache+=Math.ceil(this.worldConfig.speed),this.vy+=this.worldConfig.gravity,this.y+=this.vy,this.y>this.baseY&&(this.vy=0,this.y=this.baseY,this.onGround=!0,this.tickCount+=1,this.tickCount>this.ticksPerFrame&&(this.tickCount=0,this.frameIndex<this.nFrames-1?this.frameIndex+=1:this.frameIndex=0))}},{key:"render",value:function(){var t=document.getElementById("trex");this.drawContext.save(),this.drawContext.drawImage(t,this.frameIndex*this.heroWidth,0,this.heroWidth,this.heroHeight,this.x,this.y,this.heroWidth,this.heroHeight),this.drawContext.restore()}}])&&n(t.prototype,e),i&&n(t,i),a}();function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function a(t,e,i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.drawContext=t,this.x=e,this.y=i,this.canvasHeight=r,this.canvasWidth=n,this.bg=document.getElementById("bg"),this.bgWidth=this.canvasWidth,this.scrollSpeed=3}var t,e,i;return t=a,(e=[{key:"update",value:function(){this.bgWidth-=this.scrollSpeed,this.bgWidth<=0&&(this.bgWidth=this.canvasWidth)}},{key:"render",value:function(){this.drawContext.save(),this.drawContext.clearRect(0,this.canvasHeight-40,400,27),this.drawContext.drawImage(this.bg,this.bgWidth,this.canvasHeight-40),this.drawContext.drawImage(this.bg,this.bgWidth-this.canvasWidth,this.canvasHeight-40),this.drawContext.restore()}}])&&r(t.prototype,e),i&&r(t,i),a}(),e={checkRectAbove:function(t,e,i,n,r,a){return Math.max(t,i)<=Math.min(t+r,i+a)&&e<n},getRandomFromRange:function(t,e){return Math.random()*(e-t)+t},checkCollision:function(t,e,i,n,r,a,o,s){var h=Math.max(t,i),i=Math.min(t+r,i+a),a=Math.max(e,n),s=Math.min(e+o,n+s);return{collide:h<=i&&a<=s,ydir:e<n?-1:1}}},s=e;function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function r(t,e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.drawContext=t,this.x=e,this.y=i,this.worldConfig=n,this.width=s.getRandomFromRange(30,100),this.height=30,this.vx=s.getRandomFromRange(2,6),this.vy=0,this.remove=!1,this.hit=!1,this.falling=!1,this.colors=["#1eaaf1","#fd9727","#1ec659","#9b2fae"],this.color=this.colors[Math.floor(Math.random()*this.colors.length)],this.entityName="Obstacle"}var t,e,i;return t=r,(e=[{key:"triggerFall",value:function(){this.falling=!0}},{key:"update",value:function(){this.falling&&(this.vy+=this.worldConfig.gravity,this.y+=this.vy),this.x-=this.vx,this.remove=this.x<-100}},{key:"render",value:function(){this.drawContext.beginPath(),this.drawContext.rect(this.x,this.y,this.width,this.height),this.drawContext.fillStyle=this.color,this.drawContext.fill()}}])&&h(t.prototype,e),i&&h(t,i),r}(),e={hexToRgbA:function(t,e){if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3==(t=t.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),t="0x".concat(t.join("")),"rgba(".concat(t>>16&255,", ").concat(t>>8&255,", ").concat(255&t,", ").concat(e,")");throw new Error("Bad Hex")},singleLineText:function(t,e,i,n,r,a){t.font=i,t.fillStyle=n,t.fillText(e,r,a)},multiLineText:function(i,t,e,n,r,a,o){i.font=e,i.fillStyle=n;var s=a;t.forEach(function(t,e){i.fillText(t,r,s),s+=o})}},l=e;function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function h(t,e,i,n,r,a,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),this.drawContext=t,this.x=e,this.y=i,this.height=o,this.width=a,this.remove=!1,this.background=s,this.opacity=1,this.fade=.01,this.dir=1<2*Math.random()?1:-1,this.vx=4*Math.random()*n,this.vy=7*Math.random()*r,this.entityName="Particle"}var t,e,i;return t=h,(e=[{key:"update",value:function(){this.x+=this.vx,this.y+=this.vy,this.vx*=.99,this.vy*=.99,this.opacity-=this.fade,this.opacity<=0&&(this.remove=!0)}},{key:"render",value:function(){var t=l.hexToRgbA(this.background,this.opacity);this.drawContext.beginPath(),this.drawContext.rect(this.x,this.y,this.width,this.height),this.drawContext.fillStyle=t,this.drawContext.fill()}}])&&d(t.prototype,e),i&&d(t,i),h}();function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var g=new(function(){function r(t,e){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var n=document.getElementById("game");this.canvas=n,this.currentWidth=t,this.currentHeight=e,this.drawContext=n.getContext("2d"),this.entities=[],this.nextObstacle=0,this.scrollSpeed=4,this.lastScore=0,this.worldConfig={gravity:.31875,speed:.5},this.gameState="intro",this.touchStarted=!1,window.addEventListener("click",function(t){return i.handleTap(t)}),window.addEventListener("touchstart",function(t){return i.handleTap(t)})}var t,e,i;return t=r,(e=[{key:"init",value:function(){this.startTime=(new Date).getTime(),this.Hero=new a(this.drawContext,30,this.currentHeight-126,this.worldConfig),this.terrain=new o(this.drawContext,0,this.currentHeight-40,this.currentWidth,this.currentHeight),this.entities.push(this.terrain),this.entities.push(this.Hero)}},{key:"drawStartScreen",value:function(){this.drawContext.clearRect(0,0,this.currentWidth,this.currentHeight),l.singleLineText(this.drawContext,"Back Online!","bold 22px Monospace","#535353",140,80);l.multiLineText(this.drawContext,["You just got back online and trex ","got stuck in the devtools network tab!","How many kilobytes can it survive?","Avoid download bars and save on cache!"],"16px Monospace","#535353",20,180,25),l.singleLineText(this.drawContext,"Tap to jump and double jump!","bold 16px Monospace","#535353",80,370);var t=new a(this.drawContext,30,this.currentHeight-126,this.worldConfig);new o(this.drawContext,0,this.currentHeight-40,this.currentWidth,this.currentHeight).render(),t.render()}},{key:"drawGameOver",value:function(){this.drawContext.clearRect(0,0,this.currentWidth,this.currentHeight);var t=["You managed to survive","".concat(this.lastScore," kilobytes"),"Before running out of cache!"];l.singleLineText(this.drawContext,"Game Over!","bold 24px Monospace","#535353",100,80),l.multiLineText(this.drawContext,t,"16px Monospace","#535353",20,180,25),l.singleLineText(this.drawContext,"Tap to continue","bold 16px Monospace","#535353",100,280)}},{key:"arrangeNextObstacle",value:function(){var t=(new Date).getTime(),t=Math.floor((t-this.startTime)/60);this.nextObstacle-=1+.001*t,this.nextObstacle<0&&(this.entities.push(new c(this.drawContext,s.getRandomFromRange(600,7500),s.getRandomFromRange(70,500),this.worldConfig)),this.nextObstacle=80*Math.random()+30-.01*t,this.terrain.scrollSpeed+=.05)}},{key:"generateBlast",value:function(t,e,i,n,r,a,o){this.entities.push(new u(this.drawContext,t+a,e,i,n,a/3,a/3,o));for(var s=0;s<25;s++){var h=Math.floor(Math.random()*(r+1))+1;this.entities.push(new u(this.drawContext,t,e,i,n,h,h,o))}}},{key:"renderStatusBar",value:function(){l.singleLineText(this.drawContext,this.Hero.totalDownload,"bold 14px Monospace","#535353",10,35),l.singleLineText(this.drawContext,"Kbs Downloaded","bold 14px Monospace","#535353",10,50);var t=1e3<this.Hero.totalCache?"#01c853":"#ff0000";l.singleLineText(this.drawContext,this.Hero.totalCache,"bold 14px Monospace",t,290,35),l.singleLineText(this.drawContext,"Kbs Cached","bold 14px Monospace",t,290,50)}},{key:"resetGame",value:function(){this.lastScore=this.Hero.totalDownload,this.entities=[],this.nextObstacle=0,this.init()}},{key:"update",value:function(){var i=this;this.arrangeNextObstacle(),this.Hero.totalCache<0&&(this.gameState="game_over",this.resetGame()),this.entities.forEach(function(t,e){t.remove||t.hit?i.entities.splice(e,1):(e=s.checkCollision(t.x,t.y,i.Hero.x,i.Hero.y,t.width,i.Hero.heroWidth,t.height,i.Hero.heroHeight),"Obstacle"===t.entityName&&e.collide&&(i.Hero.takeHit(t.width),i.generateBlast(t.x,t.y,-1,e.ydir,5,t.width/2,t.color),t.hit=!0),e=s.checkRectAbove(t.x,t.y,i.Hero.x,i.Hero.y,t.width,i.Hero.heroWidth),"Obstacle"===t.entityName&&e&&t.triggerFall(),t.update())})}},{key:"resize",value:function(){var t=window.height,e=t*(this.currentWidth/this.currentHeight);this.canvas.style.width="".concat(e,"px"),this.canvas.style.height="".concat(t,"px")}},{key:"render",value:function(){this.drawContext.clearRect(0,0,this.currentWidth,this.currentHeight),this.entities.forEach(function(t){t.render()}),this.renderStatusBar()}},{key:"handleTap",value:function(t){t.preventDefault(),"intro"===this.gameState?this.gameState="game":"game_over"===this.gameState&&(this.gameState="intro")}}])&&f(t.prototype,e),i&&f(t,i),r}())(400,600);function v(){window.requestAnimationFrame(v),"game"===g.gameState?(g.update(),g.render()):"intro"===g.gameState?g.drawStartScreen():g.drawGameOver()}window.requestAnimationFrame=window.requestAnimationFrame||function(t){window.setTimeout(t,16)},window.addEventListener("load",function(){g.resize(),g.init(),v()}),window.addEventListener("resize",function(){g.resize()})}]);</script></body></html>